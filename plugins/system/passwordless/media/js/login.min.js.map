{"version":3,"sources":["login.es6"],"names":[],"mappings":"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","file":"login.min.js","sourcesContent":["/*!\n * @package   AkeebaPasswordlessLogin\n * @copyright Copyright (c)2018-2021 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   GNU General Public License version 3, or later\n */\n\nwindow.Joomla              = window.Joomla || {};\nwindow.akeeba              = window.akeeba || {};\nwindow.akeeba.Passwordless = window.akeeba.Passwordless || {};\n\n/**\n * Akeeba Passwordless Login client-side implementation\n *\n * This is the EcmaScript 6+ source of the client-side implementation. It is meant to be transpiled to ES5.1 (plain old\n * JavaScript) with Babel. The actual file being loaded can be found in dist/passwordless.js.\n */\n((Joomla, Passwordless, document) => {\n\t\"use strict\";\n\n\t/**\n\t * Converts a simple object containing query string parameters to a single, escaped query string.\n\t * This method is a necessary evil since Joomla.request can only accept data as a string.\n\t *\n\t * @param    object   {object}  A plain object containing the query parameters to pass\n\t * @param    prefix   {string}  Prefix for array-type parameters\n\t *\n\t * @returns  {string}\n\t */\n\tPasswordless.interpolateParameters = (object, prefix = '') => {\n\t\tlet encodedString = '';\n\n\t\tObject.keys(object).forEach((prop) => {\n\t\t\tif (typeof object[prop] !== 'object')\n\t\t\t{\n\t\t\t\tif (encodedString.length > 0)\n\t\t\t\t{\n\t\t\t\t\tencodedString += '&';\n\t\t\t\t}\n\n\t\t\t\tif (prefix === '')\n\t\t\t\t{\n\t\t\t\t\tencodedString += `${encodeURIComponent(prop)}=${encodeURIComponent(object[prop])}`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tencodedString\n\t\t\t\t\t\t+= `${encodeURIComponent(prefix)}[${encodeURIComponent(prop)}]=${encodeURIComponent(\n\t\t\t\t\t\tobject[prop],\n\t\t\t\t\t)}`;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Objects need special handling\n\t\t\tencodedString += `${Passwordless.interpolateParameters(object[prop], prop)}`;\n\t\t});\n\n\t\treturn encodedString;\n\t};\n\n\t/**\n\t * Finds the first field matching a selector inside a form\n\t *\n\t * @param   {HTMLFormElement}  form           The FORM element\n\t * @param   {String}           fieldSelector  The CSS selector to locate the field\n\t *\n\t * @returns {Element|null}  NULL when no element is found\n\t */\n\tPasswordless.findField = (form, fieldSelector) => {\n\t\tconst elInputs = form.querySelectorAll(fieldSelector);\n\n\t\tif (!elInputs.length)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn elInputs[0];\n\t};\n\n\t/**\n\t * Find a form field described by the CSS selector fieldSelector.\n\t * The field must be inside a <form> element which is either the\n\t * outerElement itself or enclosed by outerElement.\n\t *\n\t * @param   {Element}  outerElement   The element which is either our form or contains our form.\n\t * @param   {String}   fieldSelector  The CSS selector to locate the field\n\t *\n\t * @returns {null|Element}  NULL when no element is found\n\t */\n\tPasswordless.lookForField = (outerElement, fieldSelector) => {\n\t\tlet elInput = null;\n\n\t\tif (!outerElement)\n\t\t{\n\t\t\treturn elInput;\n\t\t}\n\n\t\tconst elElement = outerElement.parentElement;\n\n\t\tif (elElement.nodeName === 'FORM')\n\t\t{\n\t\t\telInput = Passwordless.findField(elElement, fieldSelector);\n\n\t\t\treturn elInput;\n\t\t}\n\n\t\tconst elForms = elElement.querySelectorAll('form');\n\n\t\tif (elForms.length)\n\t\t{\n\t\t\tfor (let i = 0; i < elForms.length; i += 1)\n\t\t\t{\n\t\t\t\telInput = Passwordless.findField(elForms[i], fieldSelector);\n\n\t\t\t\tif (elInput !== null)\n\t\t\t\t{\n\t\t\t\t\treturn elInput;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n\n\t/**\n\t * A simple error handler.\n\t *\n\t * @param   {String}  message\n\t */\n\tPasswordless.handleLoginError = (message) => {\n\t\tJoomla.renderMessages({error: [message]});\n\n\t\twindow.scrollTo({top: 0, left: 0, behavior: 'smooth'});\n\t};\n\n\t/**\n\t * Handles the browser response for the user interaction with the authenticator. Redirects to an\n\t * internal page which handles the login server-side.\n\t *\n\t * @param {  Object}  publicKey     Public key request options, returned from the server\n\t */\n\tPasswordless.handleLoginChallenge = (publicKey) => {\n\t\tconst arrayToBase64String = (a) => btoa(String.fromCharCode(...a));\n\n\t\tconst base64url2base64 = (input) => {\n\t\t\tlet output = input\n\t\t\t\t.replace(/-/g, '+')\n\t\t\t\t.replace(/_/g, '/');\n\t\t\tconst pad  = output.length % 4;\n\t\t\tif (pad)\n\t\t\t{\n\t\t\t\tif (pad === 1)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t'InvalidLengthError: Input base64url string is the wrong length to determine padding');\n\t\t\t\t}\n\t\t\t\toutput += new Array(5 - pad).join('=');\n\t\t\t}\n\t\t\treturn output;\n\t\t};\n\n\t\tif (!publicKey.challenge)\n\t\t{\n\t\t\tPasswordless.handleLoginError(Joomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_ERR_INVALID_USERNAME\"));\n\n\t\t\treturn;\n\t\t}\n\n\t\tpublicKey.challenge = Uint8Array.from(\n\t\t\twindow.atob(base64url2base64(publicKey.challenge)), (c) => c.charCodeAt(0),\n\t\t);\n\n\t\tif (publicKey.allowCredentials)\n\t\t{\n\t\t\tpublicKey.allowCredentials = publicKey.allowCredentials.map((data) => {\n\t\t\t\tdata.id = Uint8Array.from(window.atob(base64url2base64(data.id)), (c) => c.charCodeAt(0));\n\t\t\t\treturn data;\n\t\t\t});\n\t\t}\n\n\t\tconsole.log(publicKey);\n\n\t\tnavigator.credentials.get({publicKey})\n\t\t\t.then((data) => {\n\t\t\t\tconst publicKeyCredential = {\n\t\t\t\t\tid:       data.id,\n\t\t\t\t\ttype:     data.type,\n\t\t\t\t\trawId:    arrayToBase64String(new Uint8Array(data.rawId)),\n\t\t\t\t\tresponse: {\n\t\t\t\t\t\tauthenticatorData: arrayToBase64String(new Uint8Array(data.response.authenticatorData)),\n\t\t\t\t\t\tclientDataJSON:    arrayToBase64String(new Uint8Array(data.response.clientDataJSON)),\n\t\t\t\t\t\tsignature:         arrayToBase64String(new Uint8Array(data.response.signature)),\n\t\t\t\t\t\tuserHandle:        data.response.userHandle ? arrayToBase64String(\n\t\t\t\t\t\t\tnew Uint8Array(data.response.userHandle),\n\t\t\t\t\t\t) : null,\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\t// Send the response to your server\n\t\t\t\tconst paths = Joomla.getOptions('system.paths');\n\t\t\t\twindow.location = `${paths ? `${paths.base}/index.php` : window.location.pathname}?${Joomla.getOptions('csrf.token')}=1&option=com_ajax&group=system&plugin=passwordless`\n\t\t\t\t\t+ `&format=raw&akaction=login&encoding=redirect&data=${\n\t\t\t\t\t\tbtoa(JSON.stringify(publicKeyCredential))}`;\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\t// Example: timeout, interaction refused...\n\t\t\t\tPasswordless.handleLoginError(error);\n\t\t\t});\n\t};\n\n\t/**\n\t * Initialize the passwordless login, going through the server to get the registered certificates\n\t * for the user.\n\t *\n\t * @param   {string}   formId       The login form's or login module's HTML ID\n\t *\n\t * @returns {boolean}  Always FALSE to prevent BUTTON elements from reloading the page.\n\t */\n\t// eslint-disable-next-line no-unused-vars\n\tPasswordless.login = (formId) => {\n\t\tconst elFormContainer = document.getElementById(formId);\n\t\tconst elUsername = Passwordless.lookForField(elFormContainer, 'input[name=username]');\n\t\tconst elReturn = Passwordless.lookForField(elFormContainer, 'input[name=return]');\n\n\t\tif (elUsername === null)\n\t\t{\n\t\t\tPasswordless.handleLoginError(Joomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_ERR_CANNOT_FIND_USERNAME\"));\n\n\t\t\treturn false;\n\t\t}\n\n\t\tconst username  = elUsername.value;\n\t\tconst returnUrl = elReturn ? elReturn.value : null;\n\n\t\t// Get the Public Key Credential Request Options (challenge and acceptable public keys)\n\t\tconst postBackData = {\n\t\t\toption:      \"com_ajax\",\n\t\t\tgroup:       \"system\",\n\t\t\tplugin:      \"passwordless\",\n\t\t\tformat:      \"raw\",\n\t\t\takaction:    \"challenge\",\n\t\t\tencoding:    \"raw\",\n\t\t\t// username,\n\t\t\t// returnUrl,\n\t\t\t\"username\":  username,\n\t\t\t\"returnUrl\": returnUrl\n\t\t};\n\n\t\tconst paths = Joomla.getOptions('system.paths');\n\n\t\tJoomla.request({\n\t\t\turl:    `${paths ? `${paths.base}/index.php` : window.location.pathname}?${Joomla.getOptions(\n\t\t\t\t'csrf.token')}=1`,\n\t\t\tmethod: \"POST\",\n\t\t\tdata:   Passwordless.interpolateParameters(postBackData),\n\t\t\tonSuccess(rawResponse)\n\t\t\t{\n\t\t\t\tlet jsonData = {};\n\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tjsonData = JSON.parse(rawResponse);\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t\t/**\n\t\t\t\t\t * In case of JSON decoding failure fall through; the error will be handled in the login\n\t\t\t\t\t * challenge handler called below.\n\t\t\t\t\t */\n\t\t\t\t}\n\n\t\t\t\tif (jsonData.error)\n\t\t\t\t{\n\t\t\t\t\tPasswordless.handleLoginError(jsonData.error);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconsole.log(jsonData);\n\n\t\t\t\tconst paths = Joomla.getOptions('system.paths');\n\t\t\t\tPasswordless.handleLoginChallenge(jsonData);\n\t\t\t},\n\t\t\tonError: (xhr) => {\n\t\t\t\tPasswordless.handleLoginError(`${xhr.status} ${xhr.statusText}`);\n\t\t\t},\n\t\t});\n\n\t\treturn false;\n\t};\n\n\tPasswordless.initLogin = () => {\n\t\tconst loginButtons = [].slice.call(document.querySelectorAll(\".plg_system_passwordless_login_button\"));\n\n\t\tif (loginButtons.length)\n\t\t{\n\t\t\tloginButtons.forEach((button) => {\n\t\t\t\tbutton.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tconst currentTarget = e.currentTarget;\n\n\t\t\t\t\tPasswordless.login(\n\t\t\t\t\t\tcurrentTarget.getAttribute(\"data-passwordless-form\")\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t// Initialization. Runs on DOM content loaded since this script is always loaded deferred.\n\tPasswordless.initLogin();\n\n})(Joomla, window.akeeba.Passwordless, document);\n"]}
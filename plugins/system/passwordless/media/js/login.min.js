"use strict";function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _iterableToArray(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}window.Joomla=window.Joomla||{},window.akeeba=window.akeeba||{},window.akeeba.Passwordless=window.akeeba.Passwordless||{},function(a,b,c){"use strict";b.interpolateParameters=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",d="";return Object.keys(a).forEach(function(e){return"object"===_typeof(a[e])?void(d+="".concat(b.interpolateParameters(a[e],e))):(0<d.length&&(d+="&"),void(d+=""===c?"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a[e])):"".concat(encodeURIComponent(c),"[").concat(encodeURIComponent(e),"]=").concat(encodeURIComponent(a[e]))))}),d},b.findField=function(a,b){var c=a.querySelectorAll(b);return c.length?c[0]:null},b.lookForField=function(a,c){var d=null;if(!a)return d;var e=a.parentElement;if("FORM"===e.nodeName)return d=b.findField(e,c),d;var f=e.querySelectorAll("form");if(f.length)for(var g=0;g<f.length;g+=1)if(d=b.findField(f[g],c),null!==d)return d;return null},b.handleLoginError=function(b){a.renderMessages({error:[b]}),window.scrollTo({top:0,left:0,behavior:"smooth"})},b.handleLoginChallenge=function(c,d){var e=function(b){return btoa(String.fromCharCode.apply(String,_toConsumableArray(b)))},f=function(a){var b=a.replace(/-/g,"+").replace(/_/g,"/"),c=b.length%4;if(c){if(1===c)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");b+=Array(5-c).join("=")}return b};return c.challenge?void(c.challenge=Uint8Array.from(window.atob(f(c.challenge)),function(a){return a.charCodeAt(0)}),c.allowCredentials&&(c.allowCredentials=c.allowCredentials.map(function(a){return a.id=Uint8Array.from(window.atob(f(a.id)),function(a){return a.charCodeAt(0)}),a})),void 0,navigator.credentials.get({publicKey:c}).then(function(a){var b={id:a.id,type:a.type,rawId:e(new Uint8Array(a.rawId)),response:{authenticatorData:e(new Uint8Array(a.response.authenticatorData)),clientDataJSON:e(new Uint8Array(a.response.clientDataJSON)),signature:e(new Uint8Array(a.response.signature)),userHandle:a.response.userHandle?e(new Uint8Array(a.response.userHandle)):null}};window.location="".concat(d,"&option=com_ajax&group=system&plugin=passwordless&")+"format=raw&akaction=login&encoding=redirect&data=".concat(btoa(JSON.stringify(b)))})["catch"](function(a){b.handleLoginError(a)})):void b.handleLoginError(a.JText._("PLG_SYSTEM_PASSWORDLESS_ERR_INVALID_USERNAME"))},b.login=function(d,e){var f=c.getElementById(d),g=b.lookForField(f,"input[name=username]"),h=b.lookForField(f,"input[name=return]");if(null===g)return b.handleLoginError(a.JText._("PLG_SYSTEM_PASSWORDLESS_ERR_CANNOT_FIND_USERNAME")),!1;var i=g.value,j=h?h.value:null;return a.request({url:e,method:"POST",data:b.interpolateParameters({option:"com_ajax",group:"system",plugin:"passwordless",format:"raw",akaction:"challenge",encoding:"raw",username:i,returnUrl:j}),onSuccess:function onSuccess(a){var c={};try{c=JSON.parse(a)}catch(a){}return c.error?void b.handleLoginError(c.error):void(b.handleLoginChallenge(c,e))},onError:function onError(a){b.handleLoginError("".concat(a.status," ").concat(a.statusText))}}),!1},b.initLogin=function(){var a=[].slice.call(c.querySelectorAll(".plg_system_passwordless_login_button"));a.length&&a.forEach(function(a){a.addEventListener("click",function(a){a.preventDefault();var c=a.currentTarget;b.login(c.getAttribute("data-passwordless-form"),c.getAttribute("data-passwordless-url"))})})},b.initLogin()}(Joomla,window.akeeba.Passwordless,document);

//# sourceMappingURL=login.min.js.map
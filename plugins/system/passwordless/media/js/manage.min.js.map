{"version":3,"sources":["manage.es6"],"names":[],"mappings":"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","file":"manage.min.js","sourcesContent":["/*\n * @package   AkeebaPasswordlessLogin\n * @copyright Copyright (c)2018-2022 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   GNU General Public License version 3, or later\n */\n\nwindow.Joomla              = window.Joomla || {};\nwindow.akeeba              = window.akeeba || {};\nwindow.akeeba.Passwordless = window.akeeba.Passwordless || {};\n\n((Joomla, Passwordless, document) => {\n\t\"use strict\";\n\n\t/**\n\t * Converts a simple object containing query string parameters to a single, escaped query string.\n\t * This method is a necessary evil since Joomla.request can only accept data as a string.\n\t *\n\t * @param    object   {object}  A plain object containing the query parameters to pass\n\t * @param    prefix   {string}  Prefix for array-type parameters\n\t *\n\t * @returns  {string}\n\t */\n\tconst interpolateParameters = (object, prefix = \"\") => {\n\t\tlet encodedString = \"\";\n\n\t\tObject.keys(object).forEach((prop) => {\n\t\t\tif (typeof object[prop] !== \"object\")\n\t\t\t{\n\t\t\t\tif (encodedString.length > 0)\n\t\t\t\t{\n\t\t\t\t\tencodedString += \"&\";\n\t\t\t\t}\n\n\t\t\t\tif (prefix === \"\")\n\t\t\t\t{\n\t\t\t\t\tencodedString += `${encodeURIComponent(prop)}=${encodeURIComponent(object[prop])}`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tencodedString\n\t\t\t\t\t\t+= `${encodeURIComponent(prefix)}[${encodeURIComponent(prop)}]=${encodeURIComponent(\n\t\t\t\t\t\tobject[prop],\n\t\t\t\t\t)}`;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Objects need special handling\n\t\t\tencodedString += `${interpolateParameters(object[prop], prop)}`;\n\t\t});\n\n\t\treturn encodedString;\n\t};\n\n\t/**\n\t * A simple error handler.\n\t *\n\t * @param   {String}  message\n\t */\n\tconst reportErrorToUser = (message) => {\n\t\tJoomla.renderMessages({error: [message]});\n\n\t\twindow.scrollTo({top: 0, left: 0, behavior: 'smooth'});\n\t};\n\n\t/**\n\t * Ask the user to link an authenticator using the provided public key (created server-side).\n\t * Posts the credentials to the URL defined in post_url using AJAX.\n\t * That URL must re-render the management interface.\n\t * These contents will replace the element identified by the interface_selector CSS selector.\n\t *\n\t * @param   {String}  storeID            CSS ID for the element storing the configuration in its\n\t *                                        data properties\n\t * @param   {String}  interfaceSelector  CSS selector for the GUI container\n\t */\n\t// eslint-disable-next-line no-unused-vars\n\tPasswordless.createCredentials = (storeID, interfaceSelector) => {\n\t\t// Make sure the browser supports Webauthn\n\t\tif (!(\"credentials\" in navigator))\n\t\t{\n\t\t\treportErrorToUser(Joomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_ERR_NO_BROWSER_SUPPORT\"));\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Extract the configuration from the store\n\t\tconst elStore = document.getElementById(storeID);\n\n\t\tif (!elStore)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst publicKey = JSON.parse(atob(elStore.dataset.public_key));\n\t\tconst paths     = Joomla.getOptions('system.paths');\n\t\tconst postURL   = `${paths ? `${paths.base}/index.php` : window.location.pathname}`;\n\n\t\tconst arrayToBase64String = (a) => btoa(String.fromCharCode(...a));\n\t\tconst base64url2base64 = (input) => {\n\t\t\tlet output = input\n\t\t\t\t.replace(/-/g, '+')\n\t\t\t\t.replace(/_/g, '/');\n\t\t\tconst pad = output.length % 4;\n\t\t\tif (pad) {\n\t\t\t\tif (pad === 1) {\n\t\t\t\t\tthrow new Error('InvalidLengthError: Input base64url string is the wrong length to determine padding');\n\t\t\t\t}\n\t\t\t\toutput += new Array(5 - pad).join('=');\n\t\t\t}\n\t\t\treturn output;\n\t\t};\n\n\t\t// Convert the public key information to a format usable by the browser's credentials manager\n\t\tpublicKey.challenge = Uint8Array.from(\n\t\t\twindow.atob(base64url2base64(publicKey.challenge)), (c) => c.charCodeAt(0),\n\t\t);\n\n\t\tpublicKey.user.id = Uint8Array.from(window.atob(publicKey.user.id), (c) => c.charCodeAt(0));\n\n\t\tif (publicKey.excludeCredentials)\n\t\t{\n\t\t\tpublicKey.excludeCredentials = publicKey.excludeCredentials.map((data) => {\n\t\t\t\tdata.id = Uint8Array.from(window.atob(base64url2base64(data.id)), (c) => c.charCodeAt(0));\n\t\t\t\treturn data;\n\t\t\t});\n\t\t}\n\n\t\tconsole.log(publicKey);\n\n\t\t// Ask the browser to prompt the user for their authenticator\n\t\tnavigator.credentials.create({publicKey})\n\t\t\t.then((data) => {\n\t\t\t\tconst publicKeyCredential = {\n\t\t\t\t\tid:       data.id,\n\t\t\t\t\ttype:     data.type,\n\t\t\t\t\trawId:    arrayToBase64String(new Uint8Array(data.rawId)),\n\t\t\t\t\tresponse: {\n\t\t\t\t\t\tclientDataJSON:    arrayToBase64String(new Uint8Array(data.response.clientDataJSON)),\n\t\t\t\t\t\tattestationObject: arrayToBase64String(new Uint8Array(data.response.attestationObject)),\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\t// Send the response to your server\n\t\t\t\tconst postBackData = {\n\t\t\t\t\toption:   \"com_ajax\",\n\t\t\t\t\tgroup:    \"system\",\n\t\t\t\t\tplugin:   \"passwordless\",\n\t\t\t\t\tformat:   \"raw\",\n\t\t\t\t\takaction: \"create\",\n\t\t\t\t\tencoding: \"raw\",\n\t\t\t\t\tdata:     btoa(JSON.stringify(publicKeyCredential)),\n\t\t\t\t};\n\t\t\t\tpostBackData[Joomla.getOptions('csrf.token')] = 1;\n\n\t\t\t\tJoomla.request({\n\t\t\t\t\turl:    postURL,\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\tdata:   interpolateParameters(postBackData),\n\t\t\t\t\tonSuccess(responseHTML)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst elements = document.querySelectorAll(interfaceSelector);\n\n\t\t\t\t\t\tif (!elements)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst elContainer = elements[0];\n\n\t\t\t\t\t\telContainer.outerHTML = responseHTML;\n\n\t\t\t\t\t\tPasswordless.initManagement();\n\t\t\t\t\t},\n\t\t\t\t\tonError: (xhr) => {\n\t\t\t\t\t\treportErrorToUser(`${xhr.status} ${xhr.statusText}`);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\t// An error occurred: timeout, request to provide the authenticator refused, hardware /\n\t\t\t\t// software error...\n\t\t\t\treportErrorToUser(error);\n\t\t\t});\n\t};\n\n\t/**\n\t * Edit label button\n\t *\n\t * @param   {Element} that      The button being clicked\n\t * @param   {String}  storeID  CSS ID for the element storing the configuration in its data\n\t *                              properties\n\t */\n\t// eslint-disable-next-line no-unused-vars\n\tPasswordless.editLabel = (that, storeID) =>\n\t{\n\t\t// Extract the configuration from the store\n\t\tconst elStore = document.getElementById(storeID);\n\n\t\tif (!elStore)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst paths   = Joomla.getOptions('system.paths');\n\t\tconst postURL = `${paths ? `${paths.base}/index.php` : window.location.pathname}`;\n\n\t\t// Find the UI elements\n\t\tconst elTR         = that.parentElement.parentElement;\n\t\tconst credentialId = elTR.dataset.credential_id;\n\t\tconst elTDs        = elTR.querySelectorAll(\"td\");\n\t\tconst elLabelTD    = elTDs[0];\n\t\tconst elButtonsTD  = elTDs[1];\n\t\tconst elButtons    = elButtonsTD.querySelectorAll(\"button\");\n\t\tconst elEdit       = elButtons[0];\n\t\tconst elDelete     = elButtons[1];\n\n\t\t// Show the editor\n\t\tconst oldLabel = elLabelTD.innerText;\n\n\t\tconst elInput        = document.createElement(\"input\");\n\t\telInput.type         = \"text\";\n\t\telInput.name         = \"label\";\n\t\telInput.defaultValue = oldLabel;\n\n\t\tconst elSave     = document.createElement(\"button\");\n\t\telSave.className = \"btn btn-success btn-sm\";\n\t\telSave.innerText = Joomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_MANAGE_BTN_SAVE_LABEL\");\n\t\telSave.addEventListener(\"click\", () =>\n\t\t{\n\t\t\tconst elNewLabel = elInput.value;\n\n\t\t\tif (elNewLabel !== \"\")\n\t\t\t{\n\t\t\t\tconst postBackData = {\n\t\t\t\t\toption:        \"com_ajax\",\n\t\t\t\t\tgroup:         \"system\",\n\t\t\t\t\tplugin:        \"passwordless\",\n\t\t\t\t\tformat:        \"json\",\n\t\t\t\t\tencoding:      \"json\",\n\t\t\t\t\takaction:      \"savelabel\",\n\t\t\t\t\tcredential_id: credentialId,\n\t\t\t\t\tnew_label:     elNewLabel,\n\t\t\t\t};\n\t\t\t\tpostBackData[Joomla.getOptions('csrf.token')] = 1;\n\n\t\t\t\tJoomla.request({\n\t\t\t\t\turl:     postURL,\n\t\t\t\t\tmethod:  \"POST\",\n\t\t\t\t\tdata:    interpolateParameters(postBackData),\n\t\t\t\t\tonSuccess(rawResponse)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet result = false;\n\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult = JSON.parse(rawResponse);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (exception)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult = (rawResponse === \"true\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (result !== true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treportErrorToUser(\n\t\t\t\t\t\t\t\tJoomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_ERR_LABEL_NOT_SAVED\"),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonError: (xhr) =>\n\t\t\t\t\t\t\t {\n\t\t\t\t\t\t\t\t reportErrorToUser(\n\t\t\t\t\t\t\t\t\t `${Joomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_ERR_LABEL_NOT_SAVED\")\n\t\t\t\t\t\t\t\t\t } -- ${xhr.status} ${xhr.statusText}`,\n\t\t\t\t\t\t\t\t );\n\t\t\t\t\t\t\t },\n\t\t\t\t});\n\t\t\t}\n\n\t\t\telLabelTD.innerText = elNewLabel;\n\t\t\telEdit.disabled     = false;\n\t\t\telDelete.disabled   = false;\n\n\t\t\treturn false;\n\t\t}, false);\n\n\t\tconst elCancel     = document.createElement(\"button\");\n\t\telCancel.className = \"btn btn-danger btn-sm\";\n\t\telCancel.innerText = Joomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_MANAGE_BTN_CANCEL_LABEL\");\n\t\telCancel.addEventListener(\"click\", () =>\n\t\t{\n\t\t\telLabelTD.innerText = oldLabel;\n\t\t\telEdit.disabled     = false;\n\t\t\telDelete.disabled   = false;\n\n\t\t\treturn false;\n\t\t}, false);\n\n\t\telLabelTD.innerHTML = \"\";\n\t\telLabelTD.appendChild(elInput);\n\t\telLabelTD.appendChild(elSave);\n\t\telLabelTD.appendChild(elCancel);\n\t\telEdit.disabled   = true;\n\t\telDelete.disabled = true;\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * Delete button\n\t *\n\t * @param   {Element} that      The button being clicked\n\t * @param   {String}  storeID  CSS ID for the element storing the configuration in its data\n\t *                              properties\n\t */\n\t// eslint-disable-next-line no-unused-vars\n\tPasswordless.delete = (that, storeID) =>\n\t{\n\t\t// Extract the configuration from the store\n\t\tconst elStore = document.getElementById(storeID);\n\n\t\tif (!elStore)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst paths   = Joomla.getOptions('system.paths');\n\t\tconst postURL = `${paths ? `${paths.base}/index.php` : window.location.pathname}`;\n\n\t\t// Find the UI elements\n\t\tconst elTR         = that.parentElement.parentElement;\n\t\tconst credentialId = elTR.dataset.credential_id;\n\t\tconst elTDs        = elTR.querySelectorAll(\"td\");\n\t\tconst elButtonsTD  = elTDs[1];\n\t\tconst elButtons    = elButtonsTD.querySelectorAll(\"button\");\n\t\tconst elEdit       = elButtons[0];\n\t\tconst elDelete     = elButtons[1];\n\n\t\telEdit.disabled   = true;\n\t\telDelete.disabled = true;\n\n\t\t// Delete the record\n\t\tconst postBackData = {\n\t\t\toption:        \"com_ajax\",\n\t\t\tgroup:         \"system\",\n\t\t\tplugin:        \"passwordless\",\n\t\t\tformat:        \"json\",\n\t\t\tencoding:      \"json\",\n\t\t\takaction:      \"delete\",\n\t\t\tcredential_id: credentialId,\n\t\t};\n\t\tpostBackData[Joomla.getOptions('csrf.token')] = 1;\n\n\t\tJoomla.request({\n\t\t\turl:     postURL,\n\t\t\tmethod:  \"POST\",\n\t\t\tdata:    interpolateParameters(postBackData),\n\t\t\tonSuccess(rawResponse)\n\t\t\t{\n\t\t\t\tlet result = false;\n\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tresult = JSON.parse(rawResponse);\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t\tresult = (rawResponse === \"true\");\n\t\t\t\t}\n\n\t\t\t\tif (result !== true)\n\t\t\t\t{\n\t\t\t\t\treportErrorToUser(\n\t\t\t\t\t\tJoomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_ERR_NOT_DELETED\"),\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\telTR.parentElement.removeChild(elTR);\n\t\t\t},\n\t\t\tonError: (xhr) =>\n\t\t\t\t\t {\n\t\t\t\t\t\t elEdit.disabled   = false;\n\t\t\t\t\t\t elDelete.disabled = false;\n\t\t\t\t\t\t reportErrorToUser(\n\t\t\t\t\t\t\t `${Joomla.JText._(\"PLG_SYSTEM_PASSWORDLESS_ERR_NOT_DELETED\")\n\t\t\t\t\t\t\t } -- ${xhr.status} ${xhr.statusText}`,\n\t\t\t\t\t\t );\n\t\t\t\t\t },\n\t\t});\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * Add New Authenticator button click handler\n\t *\n\t * @param   {MouseEvent} event  The mouse click event\n\t *\n\t * @returns {boolean} Returns false to prevent the default browser button behavior\n\t */\n\tPasswordless.addOnClick = (event) =>\n\t{\n\t\tevent.preventDefault();\n\n\t\tPasswordless.createCredentials(\n\t\t\tevent.currentTarget.getAttribute(\"data-random-id\"), \"#plg_system_passwordless-management-interface\");\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * Edit Name button click handler\n\t *\n\t * @param   {MouseEvent} event  The mouse click event\n\t *\n\t * @returns {boolean} Returns false to prevent the default browser button behavior\n\t */\n\tPasswordless.editOnClick = (event) =>\n\t{\n\t\tevent.preventDefault();\n\n\t\tPasswordless.editLabel(\n\t\t\tevent.currentTarget, event.currentTarget.getAttribute(\"data-random-id\"));\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * Remove button click handler\n\t *\n\t * @param   {MouseEvent} event  The mouse click event\n\t *\n\t * @returns {boolean} Returns false to prevent the default browser button behavior\n\t */\n\tPasswordless.deleteOnClick = (event) =>\n\t{\n\t\tevent.preventDefault();\n\n\t\tPasswordless.delete(event.currentTarget, event.currentTarget.getAttribute(\"data-random-id\"));\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * Initialization on page load.\n\t */\n\tPasswordless.initManagement = () =>\n\t{\n\t\tconst addButton = document.getElementById(\"plg_system_passwordless-manage-add\");\n\n\t\tif (addButton)\n\t\t{\n\t\t\taddButton.addEventListener(\"click\", Passwordless.addOnClick);\n\t\t}\n\n\t\tconst editLabelButtons = [].slice.call(document.querySelectorAll(\".plg_system_passwordless-manage-edit\"));\n\t\tif (editLabelButtons.length)\n\t\t{\n\t\t\teditLabelButtons.forEach((button) =>\n\t\t\t{\n\t\t\t\tbutton.addEventListener(\"click\", Passwordless.editOnClick);\n\t\t\t});\n\t\t}\n\n\t\tconst deleteButtons = [].slice.call(document.querySelectorAll(\".plg_system_passwordless-manage-delete\"));\n\t\tif (deleteButtons.length)\n\t\t{\n\t\t\tdeleteButtons.forEach((button) =>\n\t\t\t{\n\t\t\t\tbutton.addEventListener(\"click\", Passwordless.deleteOnClick);\n\t\t\t});\n\t\t}\n\t};\n\n\t// Initialization. Runs on DOM content loaded since this script is always loaded deferred.\n\tPasswordless.initManagement();\n\n})(Joomla, window.akeeba.Passwordless, document);"]}